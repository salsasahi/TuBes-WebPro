<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EventHub - Profile</title>
    <link rel="stylesheet" href="profilnew.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <div class="logo">
          <a href="dashboard_new.html" class="logo">
           <div class="logo-icon">
              <img src="logoEvent.jpg" alt="EventKu Logo" />
              <h1 class="logo-text">EventKu</h1>
            </div>
          </a>
        </div>
      </div>
      <div class="header-right">
        <button class="icon-btn">
          <i class="fas fa-bell"></i>
        </button>
        <div class="user-avatar-container">
          <div class="user-avatar" id="userAvatar">
            <img
              src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100&h=100&fit=crop"
              alt="User"
            />
          </div>
          <div class="logout-popup" id="logoutPopup">
            <button class="logout-btn" id="logoutBtn">
              <i class="fas fa-sign-out-alt"></i>
              <span>Logout</span>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Welcome Section -->
      <section class="welcome-section">
        <h1 class="welcome-title">Welcome back, Sarah!</h1>
        <p class="welcome-subtitle">
          Manage your events and discover new opportunities
        </p>
      </section>

      <!-- Event Summary Cards -->
      <section class="summary-cards">
        <div class="summary-card">
          <div class="summary-icon blue">
            <i class="fas fa-calendar"></i>
          </div>
          <div class="summary-content">
            <p class="summary-label">Total Events</p>
            <h2 class="summary-number">24</h2>
          </div>
        </div>
        <div class="summary-card">
          <div class="summary-icon green">
            <i class="fas fa-clock"></i>
          </div>
          <div class="summary-content">
            <p class="summary-label">Upcoming</p>
            <h2 class="summary-number">8</h2>
          </div>
        </div>
        <div class="summary-card">
          <div class="summary-icon purple">
            <i class="fas fa-check-circle"></i>
          </div>
          <div class="summary-content">
            <p class="summary-label">Completed</p>
            <h2 class="summary-number">16</h2>
          </div>
        </div>
      </section>

      <!-- Search and Filter Bar -->
      <section class="search-filter-section">
        <div class="search-box">
          <i class="fas fa-search"></i>
          <input type="text" placeholder="Search events..." id="searchInput" />
        </div>
        <div class="filter-group">
          <select class="filter-select" id="categoryFilter">
            <option>All Categories</option>
            <option>Technology</option>
            <option>Marketing</option>
            <option>Design</option>
            <option>Business</option>
          </select>
          
          <button class="filter-btn">
            <i class="fas fa-filter"></i>
          </button>
        </div>
      </section>

      <!-- Events Container (My Events + Recommended) -->
      <div class="events-container">
        <!-- My Events Section -->
        <section id="my-events" class="my-events-section">
          <div class="section-header">
            <h2 class="section-title">My Events</h2>
            <div class="tabs">
              <button class="tab-btn active" data-tab="all">All</button>
              <button class="tab-btn" data-tab="past">Past</button>
            </div>
          </div>

          <div class="events-list" id="eventsList">
            <!-- Event Card 1 -->
            <div
              class="event-card"
              data-status="registered"
              data-date="2024-03-15"
            >
              <div class="event-date blue">
                <span class="date-month">MAR</span>
                <span class="date-day">15</span>
              </div>
              <div class="event-content">
                <h3 class="event-title">Web Development Workshop</h3>
                <p class="event-description">
                  Learn modern web development techniques with React and Node.js
                </p>
                <div class="event-details">
                  <span class="detail-item">
                    <i class="fas fa-clock"></i>
                    9:00 AM - 4:00 PM
                  </span>
                  <span class="detail-item">
                    <i class="fas fa-map-marker-alt"></i>
                    Online
                  </span>
                </div>
                <div class="event-footer">
                  <span class="status-badge registered">Registered</span>
                </div>
              </div>
            </div>

            <!-- Event Card 2 -->
            <div
              class="event-card"
              data-status="pending"
              data-date="2024-03-22"
            >
              <div class="event-date purple">
                <span class="date-month">MAR</span>
                <span class="date-day">22</span>
              </div>
              <div class="event-content">
                <h3 class="event-title">Digital Marketing Summit</h3>
                <p class="event-description">
                  Explore the latest trends in digital marketing and social
                  media
                </p>
                <div class="event-details">
                  <span class="detail-item">
                    <i class="fas fa-clock"></i>
                    9:00 AM - 5:00 PM
                  </span>
                  <span class="detail-item">
                    <i class="fas fa-map-marker-alt"></i>
                    Jakarta Convention Center
                  </span>
                </div>
                <div class="event-footer">
                  <span class="status-badge completed">Completed</span>
                </div>
              </div>
            </div>

            <!-- Event Card 3 -->
            <div
              class="event-card"
              data-status="completed"
              data-date="2024-02-28"
            >
              <div class="event-date green">
                <span class="date-month">FEB</span>
                <span class="date-day">28</span>
              </div>
              <div class="event-content">
                <h3 class="event-title">UI/UX Design Masterclass</h3>
                <p class="event-description">
                  Master the fundamentals of user interface and experience
                  design
                </p>
                <div class="event-details">
                  <span class="detail-item">
                    <i class="fas fa-clock"></i>
                    1:00 PM - 6:00 PM
                  </span>
                  <span class="detail-item">
                    <i class="fas fa-map-marker-alt"></i>
                    Online
                  </span>
                </div>
                <div class="event-footer">
                  <span class="status-badge completed">Completed</span>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Recommended Events Section -->
        <section class="recommended-section">
          <h2 class="section-title">Event Terbaru</h2>
          <div class="recommended-list">
            <!-- Recommended Event 1 -->
            <div class="recommended-card">
              <div class="recommended-image">
                <img
                  src="tech.jpg"
                  alt="Tech Innovation Conference"
                />
              </div>
              <div class="recommended-content">
                <h3 class="recommended-title">Tech Innovation Conference</h3>
                <p class="recommended-details">April 5, 2024 • Online</p>
                <button class="register-btn">Register Now</button>
              </div>
            </div>

            <!-- Recommended Event 2 -->
            <div class="recommended-card">
              <div class="recommended-image">
                <img
                  src="https://images.unsplash.com/photo-1511578314322-379afb476865?w=400&h=250&fit=crop"
                  alt="Leadership Workshop"
                />
              </div>
              <div class="recommended-content">
                <h3 class="recommended-title">Leadership Workshop</h3>
                <p class="recommended-details">April 12, 2024 • Surabaya</p>
                <button class="register-btn">Register Now</button>
              </div>
            </div>

            <!-- Recommended Event 3 -->
            <div class="recommended-card">
              <div class="recommended-image">
                <img
                  src="https://images.unsplash.com/photo-1586717791821-3f44a563fa4c?w=400&h=250&fit=crop"
                  alt="Creative Design Workshop"
                />
              </div>
              <div class="recommended-content">
                <h3 class="recommended-title">Creative Design Workshop</h3>
                <p class="recommended-details">April 18, 2024 • Bandung</p>
                <button class="register-btn">Register Now</button>
              </div>
            </div>
          </div>
        </section>
      </div>
    </main>

    <script>
      // Tab Navigation
      const tabButtons = document.querySelectorAll(".tab-btn");
      const eventCards = document.querySelectorAll(".event-card");

      tabButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          // Remove active class from all tabs
          tabButtons.forEach((b) => b.classList.remove("active"));
          // Add active class to clicked tab
          btn.classList.add("active");

          const tab = btn.dataset.tab;
          const today = new Date();
          today.setHours(0, 0, 0, 0);

          eventCards.forEach((card) => {
            const cardDate = new Date(card.dataset.date);
            cardDate.setHours(0, 0, 0, 0);

            if (tab === "all") {
              card.style.display = "flex";
            } else if (tab === "upcoming") {
              card.style.display = cardDate >= today ? "flex" : "none";
            } else if (tab === "past") {
              card.style.display = cardDate < today ? "flex" : "none";
            }
          });
        });
      });

      // Search Functionality
      const searchInput = document.getElementById("searchInput");
      searchInput.addEventListener("input", (e) => {
        const searchTerm = e.target.value.toLowerCase();
        eventCards.forEach((card) => {
          const title = card
            .querySelector(".event-title")
            .textContent.toLowerCase();
          const description = card
            .querySelector(".event-description")
            .textContent.toLowerCase();

          if (title.includes(searchTerm) || description.includes(searchTerm)) {
            card.style.display = "flex";
          } else {
            card.style.display = "none";
          }
        });
      });

      // Filter Functionality
      const categoryFilter = document.getElementById("categoryFilter");

      function applyFilters() {
        const category = categoryFilter.value.toLowerCase();

        eventCards.forEach((card) => {
          let show = true;
          // Category filter dapat ditambahkan di sini jika diperlukan
          card.style.display = show ? "flex" : "none";
        });
      }

      if (categoryFilter) {
        categoryFilter.addEventListener("change", applyFilters);
      }

      // Register Button Functionality
      const registerButtons = document.querySelectorAll(".register-btn");
      console.log("Found register buttons:", registerButtons.length);
      
      registerButtons.forEach((btn, index) => {
        btn.addEventListener("click", (e) => {
          e.preventDefault();
          console.log("Register button clicked, index:", index);
          
          const card = btn.closest(".recommended-card");
          const eventTitle = card.querySelector(".recommended-title").textContent;
          const eventDetails = card.querySelector(".recommended-details").textContent;
          const eventImage = card.querySelector(".recommended-image img").src;
          
          // Parse tanggal dan lokasi dari details (format: "April 5, 2024 • Online")
          const detailsParts = eventDetails.split(' • ');
          const eventDate = detailsParts[0] || 'TBA';
          const eventLocation = detailsParts[1] || 'TBA';
          
          // Data event yang berbeda untuk setiap kartu
          const eventDataList = [
            {
              title: 'Tech Innovation Conference',
              category: 'Technology',
              date: 'April 5, 2024',
              time: '09:00 AM – 05:00 PM',
              location: 'Online',
              address: 'Virtual Event via Zoom',
              price: 50000,
              description: 'Join the biggest technology conference of the year featuring industry experts and innovative solutions.',
              image: eventImage
            },
            {
              title: 'Leadership Workshop',
              category: 'Business',
              date: 'April 12, 2024',
              time: '08:00 AM – 04:00 PM',
              location: 'Surabaya',
              address: 'Grand City Convention Center, Surabaya',
              price: 75000,
              description: 'Develop your leadership skills with hands-on workshops led by experienced business leaders.',
              image: eventImage
            },
            {
              title: 'Creative Design Workshop',
              category: 'Design',
              date: 'April 18, 2024',
              time: '10:00 AM – 06:00 PM',
              location: 'Bandung',
              address: 'Trans Convention Centre, Bandung',
              price: 60000,
              description: 'Unleash your creativity in this immersive design workshop covering UI/UX and graphic design.',
              image: eventImage
            }
          ];
          
          // Simpan data event ke localStorage untuk digunakan di halaman detail
          const eventData = eventDataList[index] || {
            title: eventTitle,
            category: 'General',
            date: eventDate,
            time: '09:00 AM – 05:00 PM',
            location: eventLocation,
            address: eventLocation,
            price: 40000,
            description: 'Join us for this exciting event!',
            image: eventImage
          };
          
          localStorage.setItem('selectedEvent', JSON.stringify(eventData));
          
          // Redirect ke halaman detail-event
          window.location.href = 'detail-event.html';
        });
      });

      // View Details Link
      const actionLinks = document.querySelectorAll(".action-link");
      actionLinks.forEach((link) => {
        link.addEventListener("click", (e) => {
          e.preventDefault();
          const eventTitle = link
            .closest(".event-card")
            .querySelector(".event-title").textContent;
          alert(`Viewing details for: ${eventTitle}`);
        });
      });

      // Notification Bell
      const notificationBtn = document.querySelector(".icon-btn");
      notificationBtn.addEventListener("click", () => {
        alert("You have 3 new notifications!");
      });

      // Isolasi scroll pada Recommended Events Section
      const recommendedSection = document.querySelector(".recommended-section");
      if (recommendedSection) {
        recommendedSection.addEventListener("wheel", (e) => {
          const element = recommendedSection;
          const isAtTop = element.scrollTop === 0;
          const isAtBottom =
            element.scrollHeight - element.scrollTop === element.clientHeight;

          // Jika scroll ke atas dan sudah di atas, atau scroll ke bawah dan sudah di bawah
          // Biarkan scroll ke parent (halaman utama)
          if ((e.deltaY < 0 && isAtTop) || (e.deltaY > 0 && isAtBottom)) {
            return; // Biarkan scroll event bubble up
          }

          // Jika masih ada konten untuk di-scroll, cegah scroll ke parent
          e.stopPropagation();
        });

        // Mencegah scroll dengan touch pada mobile
        let touchStartY = 0;
        recommendedSection.addEventListener("touchstart", (e) => {
          touchStartY = e.touches[0].clientY;
        });

        recommendedSection.addEventListener("touchmove", (e) => {
          const touchY = e.touches[0].clientY;
          const element = recommendedSection;
          const isAtTop = element.scrollTop === 0;
          const isAtBottom =
            element.scrollHeight - element.scrollTop === element.clientHeight;

          const scrollingDown = touchY < touchStartY;
          const scrollingUp = touchY > touchStartY;

          if ((scrollingUp && isAtTop) || (scrollingDown && isAtBottom)) {
            return; // Biarkan scroll event bubble up
          }

          e.stopPropagation();
        });
      }

      // Logout Popup Toggle
      const userAvatar = document.getElementById("userAvatar");
      const logoutPopup = document.getElementById("logoutPopup");
      const logoutBtn = document.getElementById("logoutBtn");

      userAvatar.addEventListener("click", (e) => {
        e.stopPropagation();
        logoutPopup.classList.toggle("show");
      });

      document.addEventListener("click", (e) => {
        if (!logoutPopup.contains(e.target) && !userAvatar.contains(e.target)) {
          logoutPopup.classList.remove("show");
        }
      });

      logoutBtn.addEventListener("click", () => {
        if (confirm("Apakah Anda yakin ingin logout?")) {
          localStorage.removeItem("userData");
          localStorage.removeItem("isLoggedIn");
          window.location.href = "login.html";
        }
      });
    </script>
  </body>
</html>
